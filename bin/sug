#!/bin/bash

PREFIX="/Users/niannian/Lab"

GIT_REPO=(
        "amazon-freertos"
        "darwin-xnu"
        "f9-kernel"
        "linux"
        "lwip"
        "mbed-coap"
        "mbed-os"
        "mbedtls"
        "openssl"
        "uvisor"
        "wolfmqtt-0.14.0"
        "zephyr"
        )

for git_repo in ${GIT_REPO[@]}; do
    pushd "$PREFIX/$git_repo" >& /dev/null

    if [ -e .git ]; then
        echo "[ CHCKING ] $PREFIX/$git_repo"
        ret=`git pull --no-stat | grep "Already up to date\."`
        if [ "1" == "$ret" ]; then
            cscope -Rkb >& /dev/null
            ctags -R >& /dev/null
            echo "[ UPDATED ] $PREFIX/$git_repo"
        else
            echo "[ UP2DATE ] $PREFIX/$git_repo"
        fi
    fi

    popd >& /dev/null
done
